<!DOCTYPE html>
<html>

<head>
   <title>Leaflet sample</title>
   <link rel="stylesheet" href="css/style.css">
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin="" />
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""></script>
   <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
   <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
   <script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
   <script src="js/panel.js" type="text/javascript"></script>
</head>

<body>
   
   <div class="slide_panel_wrap">
      <div id="map"  class="map"></div>
		<div class="left_panel">
			<p class="open"></p>
         <p>Расчитать cтатический маршрут</p>
         <button class="calculateRoad">Расчитать маршрут</button>
      </div>
      	
		<div class="right_panel">
			<p class="open"></p>
         <p>Расчитать динамический маршрут</p>
         <button class="#">Расчитать маршрут</button>
		</div>		
	</div>
   <script>
      // Creating map options
      var mapOptions = {
         center: [47.237265, 39.712304],
         zoom: 17
      }

      // Icon options
      var iconOptions = {
         iconUrl: 'img/school.png',
         iconSize: [50, 50]
      };

      // Creating a custom icon
      var customIcon = L.icon(iconOptions);

      // Creating a map object
      var map = new L.map('map', mapOptions);

      // Creating a Layer object
      var layer = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');

      // Adding layer to the map
      map.addLayer(layer);

      // Creating a marker
      var marker = L.marker([47.237265, 39.712304]);

      // Adding popup to the marker
      marker.bindPopup('Это ДГТУ').openPopup();

      marker.setIcon(customIcon);

      // Adding marker to the map
      marker.addTo(map);

      let calculateRoad = document.querySelector('.calculateRoad');
      var marker1 = L.marker();
      var popup = L.popup();

      function onMapClick(e) {
         marker1.setLatLng(e.latlng);
         marker1.bindPopup("Наше местоположение").openPopup();
         marker1.addTo(map);
      }
      map.on('click', onMapClick);
      var road;

      calculateRoad.onclick = function () {
         if (road != null) {
            map.removeControl(road);
            road = null;
         }
         road = L.Routing.control({
            waypoints: [
               L.latLng(marker1.getLatLng()),
               L.latLng(47.237265, 39.712304)
            ],
            lineOptions: { styles: [{ color: '#9932CC', opacity: 0.95, weight: 5 }] },
            routeWhileDragging: true
         });
         road.addTo(map);


         setTimeout(function () {
            var a = road._routes[0].coordinates;
            console.log(a);
            var b = a;
         }, 3000);


      };

   </script>
</body>

</html>